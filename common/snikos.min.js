let snikos={scene:undefined,camera:undefined,renderer:undefined,geometry:new THREE.BoxGeometry(25,25,25,5,5,5),offset:25,animation:new TimelineMax({repeat:0,delay:1}),times:0,gearSize(selector,index){return document.querySelectorAll(selector)[index];},go(idx,width,height){let heart;let cubes=[];let groups=[];this.initScene();this.initCamera(width,height);this.initLights();this.initRenderer(idx,width,height);this.switchLetter(heart,groups,cubes);this.rotateHeart(groups,cubes);this.fitToHeart(cubes);this.rendero(cubes);this.handle(idx,groups,cubes);},handle(idx,groups,cubes){document.querySelectorAll('.gear')[0].addEventListener("click",(e)=>{this.handleAnimo(groups,cubes);return false;});},initScene(){this.scene=new THREE.Scene();},initCamera(w,h){this.camera=new THREE.PerspectiveCamera(35,w/h,0.1,800);this.camera.position.y=0;this.camera.position.x=0;this.camera.position.z=600;this.camera.lookAt(this.scene.position);},initLights(){let light=new THREE.DirectionalLight(0xffffff,1);light.position.set(100,100,100);this.scene.add(light);let light2=new THREE.DirectionalLight(0xffffff,1);light2.position.set(-100,100,100);this.scene.add(light2);},initRenderer(idx,w,h){this.renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});this.renderer.setSize(w,h);this.renderer.setClearColor(0x000000,0);document.querySelectorAll('.gear')[idx].appendChild(this.renderer.domElement);this.renderer.info.reset();},objLet:{"S":[[-35,0,35],[-70,-35,35,70],[70],[70,35],[-35,0,35],[-70,-35],[-70],[-70,-35,35,70],[-35,0,35]],"N":[[-95,-65,65,95],[-95,-65,65,95],[-95,-65,25,65,95],[-95,-65,25,65,95],[-95,-65,0,65,95],[-95,-65,-25,65,95],[-95,-65,-25,65,95],[-95,-65,65,95],[-95,-65,65,95]],"I":[[-65,-35,0,35,65],[-25,25],[-15,15],[-15,15],[-15,15],[-15,15],[-15,15],[-25,25],[-65,-35,0,35,65]],"K":[[-95,-65,65,95],[-95,-65,65,95],[-95,-65,5,35,65],[-95,-65,-35,-5,25],[-95,-65,-35],[-95,-65,-35,-5,25],[-95,-65,5,35,65],[-95,-65,65,95],[-95,-65,65,95]],"O":[[-30,0,30],[-60,-30,30,60],[-75,-45,45,75],[-95,-65,65,95],[-95,95],[-95,-65,65,95],[-75,-45,45,75],[-60,-30,30,60],[-30,0,30]]},switchLetter(heart,groups,cubes){return this.createOneLetter(heart,groups,cubes);},createOneLetter(heart,groups,cubes){const word=["S","N","I","K","O","S"];heart=new THREE.Group();this.scene.add(heart);word.forEach((letter,idx)=>{this.objLet[letter].forEach((item,index)=>{return this.createLevelLet(index,item,heart,groups,cubes,idx);})});},createLevelLet(level,arr,heart,groups,cubes,idx){let group=new THREE.Group();group.level=level;let color=0x03A9F4;heart.add(group);groups.push(group);group.position.x=(idx+=-2.5)*250;group.position.y=-120+(this.offset+5)*level;let x=0;for(let i=0;i<arr.length;++i){x=arr[i];if(level%2){color=0x7bcef3;}
let material=new THREE.MeshPhongMaterial({color:color});let cube0=new THREE.Mesh(this.geometry,material);let cube1=new THREE.Mesh(this.geometry,material);cubes.push(cube0,cube1);cube0.position.set(x,0,this.offset/1.5);cube1.position.set(x,0,-this.offset/1.5);group.add(cube0);group.add(cube1);}},fitToHeart(cubes){let animation=new TimelineMax();for(let i=0,len=cubes.length;i<len;++i){let cube=cubes[i];let x=cube.position.x;let y=cube.position.y;let z=cube.position.z;cube.position.x=parseInt((-5+2*Math.random())*10);cube.position.y=parseInt((-5+2*Math.random())*10);cube.position.z=parseInt((-5+2*Math.random())*15);snikos.animation.to(cube.position,3,{x:x,y:y,z:z,ease:Expo.easeInOut},0);}},rendero(){requestAnimationFrame(snikos.rendero);snikos.renderer.render(snikos.scene,snikos.camera);if(snikos.times>=3000){cancelAnimationFrame(snikos.times);snikos.times=0;console.log(`Timer is out: ${snikos.times}`);}},handleAnimo(){requestAnimationFrame(snikos.handleAnimo);snikos.renderer.render(snikos.scene,snikos.camera);},rotateHeart(groups,cubes){for(let i=0,len=groups.length,r=len-1;i<len;++i,r--){let group=groups[i];let groupR=groups[r];let ran=(i%2===0)?'-':'';snikos.animation.to(group.rotation,0.2,{x:-0.05*group.level},0).to(group.rotation,2.5,{x:2*Math.PI,ease:Expo.easeInOut,delay:0.2},0.05*group.level).to(groupR.rotation,1.5,{y:2*Math.PI,ease:Expo.easeInOut,delay:2},0.025*group.level);}},init(idx,letter){let w=this.gearSize('.gear',0)['offsetWidth'];let h=this.gearSize('.gear',0)['offsetHeight'];snikos.go(0,w,h);}};document.addEventListener("DOMContentLoaded",function(){snikos.init(0);});